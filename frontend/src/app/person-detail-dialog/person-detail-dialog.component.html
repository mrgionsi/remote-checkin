<!-- First column for images -->
<div class="dialog-container">
    <div class="dialog-images">
        <div class="image-container" *ngIf="person.images?.front">
            <p-image class="img" [src]="person.images?.front" [alt]="'front-image-label' | transloco" width="90%"
                [preview]="true" styleClass="zoomable-image shadow-2 rounded-image" />
            <div class="button-group">
                <p-button pButton type="button" icon="pi pi-download" class="p-button-rounded p-button-info"
                    (click)="forceDownload(person.images?.front)"
                    [pTooltip]="'download-image-tooltip' | transloco"></p-button>
            </div>
        </div>

        <div class="image-container" *ngIf="person.images?.back">
            <p-image class="img" [src]="person.images?.back" [alt]="'back-image-label' | transloco" width="90%"
                [preview]="true" styleClass="zoomable-image shadow-2 rounded-image" />
            <div class="button-group">
                <p-button pButton type="button" icon="pi pi-download" class="p-button-rounded p-button-info"
                    (click)="forceDownload(person.images?.back)"
                    [pTooltip]="'download-image-tooltip' | transloco"></p-button>
            </div>
        </div>

        <div class="image-container" *ngIf="person.images?.selfie">
            <p-image class="img" [src]="person.images?.selfie" [alt]="'selfie-image-label' | transloco" width="90%"
                [preview]="true" styleClass="zoomable-image shadow-2 rounded-image" />
            <div class="button-group">
                <p-button pButton type="button" icon="pi pi-download" class="p-button-rounded p-button-info"
                    (click)="forceDownload(person.images?.selfie)"
                    [pTooltip]="'download-image-tooltip' | transloco"></p-button>
            </div>
        </div>
    </div>

    <!-- Second column for details -->
    <p-card class="details-card">
        <ng-template pTemplate="title">
            <i class="pi pi-user"></i> {{ 'client-details-title' | transloco }}
        </ng-template>

        <ng-template pTemplate="content">
            <div class="details-grid">
                <div class="detail-item">
                    <i class="pi pi-id-card"></i>
                    <strong>{{ 'name-label' | transloco }}</strong> {{ person.name }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-id-card"></i>
                    <strong>{{ 'surname-label' | transloco }}</strong> {{ person.surname }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-calendar"></i>
                    <strong>{{ 'birthday-label' | transloco }}</strong> {{ person.birthday | date:'dd-MM-yyyy' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-map-marker"></i>
                    <strong>{{ 'street-label' | transloco }}</strong> {{ person.street }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-map"></i>
                    <strong>{{ 'city-label' | transloco }}</strong> {{ person.city }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-globe"></i>
                    <strong>{{ 'province-label' | transloco }}</strong> {{ person.province }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-envelope"></i>
                    <strong>{{ 'cap-label' | transloco }}</strong> {{ person.cap }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-phone"></i>
                    <strong>{{ 'telephone-label' | transloco }}</strong> {{ person.telephone }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-id-card"></i>
                    <strong>{{ 'document-number-label' | transloco }}</strong> {{ person.document_number }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-lock"></i>
                    <strong>{{ 'cf-label' | transloco }}</strong> {{ person.cf }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-file"></i>
                    <strong>{{ 'document-type-label' | transloco }}</strong> {{ person.document_type | documentTypeLabel
                    | transloco }}
                </div>

                <!-- Portale Alloggi Fields Section -->
                <div class="detail-section">
                    <h4>{{ 'portale-alloggi-fields' | transloco }}</h4>
                </div>

                <div class="detail-item">
                    <i class="pi pi-users"></i>
                    <strong>{{ 'gender-label' | transloco }}</strong>
                    <!-- Debug: {{ person.sesso }} ({{ typeof person.sesso }}) -->
                    <span *ngIf="person.sesso == 1 || person.sesso === '1'">{{ 'male' | transloco }}</span>
                    <span *ngIf="person.sesso == 2 || person.sesso === '2'">{{ 'female' | transloco }}</span>
                    <span
                        *ngIf="person.sesso == null || person.sesso === undefined || person.sesso === '' || (person.sesso != 1 && person.sesso !== '1' && person.sesso != 2 && person.sesso !== '2')">{{
                        'gender-not-specified' | transloco }}</span>
                </div>
                <div class="detail-item">
                    <i class="pi pi-flag"></i>
                    <strong>{{ 'nationality-label' | transloco }}</strong> {{ person.nazionalita || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-envelope"></i>
                    <strong>{{ 'email-label' | transloco }}</strong> {{ person.email || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-map-marker"></i>
                    <strong>{{ 'birth-municipality-label' | transloco }}</strong> {{ person.comune_nascita || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-globe"></i>
                    <strong>{{ 'birth-province-label' | transloco }}</strong> {{ person.provincia_nascita || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-flag"></i>
                    <strong>{{ 'birth-country-label' | transloco }}</strong> {{ person.stato_nascita || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-id-card"></i>
                    <strong>{{ 'citizenship-label' | transloco }}</strong> {{ person.cittadinanza || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-map-marker"></i>
                    <strong>{{ 'document-issue-place-label' | transloco }}</strong> {{ person.luogo_emissione || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-calendar"></i>
                    <strong>{{ 'document-issue-date-label' | transloco }}</strong> {{ person.data_emissione ?
                    (person.data_emissione | date:'dd-MM-yyyy') : '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-calendar-times"></i>
                    <strong>{{ 'document-expiry-date-label' | transloco }}</strong> {{ person.data_scadenza ?
                    (person.data_scadenza | date:'dd-MM-yyyy') : '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-building"></i>
                    <strong>{{ 'issuing-authority-label' | transloco }}</strong> {{ person.autorita_rilascio || '-' }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-home"></i>
                    <strong>{{ 'residence-municipality-label' | transloco }}</strong> {{ person.comune_residenza || '-'
                    }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-globe"></i>
                    <strong>{{ 'residence-province-label' | transloco }}</strong> {{ person.provincia_residenza || '-'
                    }}
                </div>
                <div class="detail-item">
                    <i class="pi pi-flag"></i>
                    <strong>{{ 'residence-country-label' | transloco }}</strong> {{ person.stato_residenza || '-' }}
                </div>
            </div>
        </ng-template>
    </p-card>

</div>

<p-dialog [(visible)]="fullscreenVisible" [style]="{width: '100vw', height: '100vh'}" [closable]="true" [modal]="true">
    <p-image *ngIf="fullscreenImage" [src]="fullscreenImage" [alt]="'zoomable-image-alt' | transloco" [preview]="true"
        styleClass="zoomable-image">
    </p-image>
</p-dialog>